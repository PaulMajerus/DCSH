% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/conversionHRS.R
\name{conversionHRS}
\alias{conversionHRS}
\title{Conversion des données HRS entre services-lieux (SH/SM) et services de prise en charge}
\usage{
conversionHRS(lst_df = list())
}
\arguments{
\item{lst_df}{Une liste de data.frames contenant :
\itemize{
\item au moins une table avec des colonnes commençant par \code{sh} ou \code{sm},
\item au moins une table contenant les variables \code{adna}, \code{DocName},
\code{sods} et \code{idcf}.
}}
}
\value{
Une liste de data.frames de même longueur que \code{lst_df},
avec remplacement des données SH/SM pour le second semestre 2022 (HRS uniquement).
}
\description{
Cette fonction convertit, pour le périmètre HRS, les données issues des tables
de type \code{sh*} (services-lieux) et \code{sm*} (services de prise en charge)
pour le second semestre 2022, en échangeant leur structure de variables.
}
\details{
La conversion est réalisée uniquement pour les enregistrements :
\itemize{
\item dont l'année est 2022 (via la variable \code{sods}),
\item appartenant à l'établissement HRS (\code{idcf == "70129077"}),
\item et à partir du 1er juillet 2022.
}

Concrètement :
\itemize{
\item les lignes SH du second semestre 2022 sont transformées en SM,
\item les lignes SM du second semestre 2022 sont transformées en SH,
\item les autres périodes et établissements ne sont pas modifiés.
}

La fonction repose sur une table de correspondance interne entre noms de colonnes
SH et SM (ex : \code{shsi <-> smce}, \code{shdd <-> smdd}, etc.).

La fonction :
\enumerate{
\item détecte automatiquement les tables SH, SM et la table contenant \code{sods},
\item enrichit les tables SH/SM par jointure avec la table des dates,
\item identifie les sous-ensembles SH 2022 et SM 2022,
\item effectue la conversion de structure via renommage de colonnes,
\item remplace les lignes correspondantes dans les tables d'origine,
\item restaure strictement les colonnes initiales de chaque table.
}

La fonction ne modifie pas :
\itemize{
\item les années différentes de 2022,
\item les établissements autres que HRS,
\item les tables ne contenant pas de colonnes SH/SM.
}
}
\note{
Cette fonction est fortement dépendante :
\itemize{
\item des noms de colonnes (\code{sh*}, \code{sm*}, \code{sods}, \code{idcf}),
\item du format de \code{sods} (doit être coercible en date),
\item du code établissement HRS fixé en dur (\code{"70129077"}).
}

Toute modification du schéma de données peut rendre la fonction incorrecte
sans générer d'erreur explicite.
}
\seealso{
\code{\link[dplyr]{rename}}, \code{\link[dplyr]{left_join}},
\code{\link[lubridate]{ymd}}
}
\author{
MAJERUS Paul
}
